---
layout: post
title: Nmap scan
meta: FTP with anonymous login is interesting.
category: htb
image: card1-img.png
date: 2020-10-22T03:41:05.960Z
tags: " "
---
Nmap scan

![](nmap-scan.png)

FTP with anonymous login is interesting. 

Hmmm, looks like I cant connect

![](ftp-error-conecting.png)

Lets use debug mode `ftp -d` to see if we can find out why?

![](ftp-debug-mode.png)

Wait, why is the PORT command sending that local address.

![](local-ip-address-comparison.png)

Ah of course, makes sense now. I am connecting via WSL and the local IP Address being sent to the remote FTP server is a local address which it cant use. Lets switch to passive mode `ftp -p`.

![](ftp-passive-mode-connection.png)

So it looks like we are in the root of the web server judging by the `.htm` extension files. 

Lets test a theory!

![](welcome-image-webserver-root.png)

Web request for default iis server page.

![](invoke-webrequest-default-server-page.png)

So it looks like we are in the root of the webserver. Let's try and upload a webshell. First lets locate our webshells in Kali Linux

![](webshell-aspx.png)

Now we upload the shell

![](upload-web-shell.png)

Looks like we are in business

![](webshell-in-browser.png)

Whoami

![](whoami.png)


Privs

![](privilleges.png)

Lets try and get a better shell to the box

```
netsh interface portproxy add v4tov4 listenport=9999 listenaddress=0.0.0.0 connectport=9999 connectaddress=172.27.215.201
```

![](empire-listener-stager.png)

Lets upload our payload

![](upload-payload.png)

So far so good 

![](payload-uploaded.png)

![](empire-shell.png)

Lets run powerup

![](powerup.png)

![](no-powerup-checks.png)

ok now lets try sherlock 

![](sherlock.png)


looks like we have some potential exploits

![](potential-exploits.png)

Let us get a reverse shell in meterpreter

![](create-reverse-shell-aspx.png)



![](meterpreter-shell.png)


![](local-privesc.png)

![](local-privesc-exploit.png)

Standard User

![](stduser.png)


Root user

![](root-user.png)
























Let use gain a more interactive shell using Nishang

![](nishang-tcp-listener.png)

![](invoke-web-shell.png)





lets download and upload the exploit 

![](uploading-exploit.png)